<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Nicolas Server</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
*{box-sizing:border-box;font-family:'Inter',sans-serif}
body{
margin:0;height:100vh;
background:linear-gradient(135deg,#6366f1,#8b5cf6);
overflow:hidden;
}
.hidden{display:none}

/* WELCOME */
#welcome{
position:fixed;inset:0;
display:flex;align-items:center;justify-content:center;
background:radial-gradient(circle at top,#6366f1,#312e81);
color:#fff;z-index:999;
animation:fadeOut 1s ease forwards;
animation-delay:2.5s;
}
#welcome h1{font-size:34px;letter-spacing:3px}

/* LOGIN */
#login{
position:fixed;inset:0;
display:flex;align-items:center;justify-content:center;
backdrop-filter:blur(18px);
background:rgba(15,23,42,.45);
z-index:500;
}
.login-box{
width:320px;padding:30px;
border-radius:26px;
background:rgba(255,255,255,.15);
box-shadow:0 30px 80px rgba(0,0,0,.4);
color:#fff;
animation:pop .5s ease;
}
.login-box h2{text-align:center}
.login-box select,.login-box input,.login-box button{
width:100%;padding:12px;margin:10px 0;
border:none;border-radius:14px;
}
.login-box button{
background:#fff;color:#4f46e5;font-weight:600;cursor:pointer;
}

/* APP */
#app{display:flex;height:100%}
.sidebar{
width:260px;padding:20px;
background:rgba(255,255,255,.12);
backdrop-filter:blur(16px);
color:#fff;
}
.avatar{
width:64px;height:64px;border-radius:50%;
background:#fff;color:#4f46e5;
display:flex;align-items:center;justify-content:center;
font-size:26px;font-weight:700;margin:auto;
}
.username{text-align:center;margin:12px 0}
.menu button{
width:100%;padding:14px;margin:8px 0;
border:none;border-radius:16px;
background:rgba(255,255,255,.18);
color:#fff;cursor:pointer;
transition:.3s;
}
.menu button:hover{background:rgba(255,255,255,.3);transform:translateX(6px)}

.main{
flex:1;padding:30px;
background:#f8fafc;
overflow:auto;
border-top-left-radius:40px;
}
.card{
background:#fff;padding:20px;
border-radius:24px;
box-shadow:0 15px 40px rgba(0,0,0,.12);
margin-bottom:20px;
animation:pop .4s ease;
}
textarea,input{width:100%;padding:12px;border-radius:14px;margin:8px 0}
pre{background:#020617;color:#fff;padding:14px;border-radius:14px;overflow:auto}

@keyframes pop{from{opacity:0;transform:scale(.9)}to{opacity:1}}
@keyframes fadeOut{to{opacity:0;visibility:hidden}}
</style>
</head>

<body>

<!-- WELCOME -->
<div id="welcome"><h1>Welcome to Nicolas Server</h1></div>

<!-- LOGIN -->
<div id="login">
  <div class="login-box">
    <h2>Backburner Login</h2>
    <select id="userInput">
      <option>Nicolas Tok</option>
      <option>clairine</option>
      <option>wixander</option>
      <option>angel</option>
    </select>
    <input id="passInput" type="password" placeholder="Password">
    <button onclick="login()">Masuk</button>
  </div>
</div>

<!-- APP -->
<div id="app" class="hidden">
  <div class="sidebar">
    <div class="avatar" id="ava"></div>
    <div class="username" id="uname"></div>
    <div class="menu" id="menu"></div>
  </div>

  <div class="main">
    <div id="home"></div>

    <div id="editor" class="hidden">
      <h2>Upload Materi (Admin)</h2>
      <input id="fileName" placeholder="Nama File">
      <textarea id="codeArea"></textarea>
      <button onclick="uploadMateri()">Upload ke Beranda</button>
    </div>

    <div id="submit" class="hidden">
      <h2>Kumpul Tugas</h2>
      <input id="taskTitle" placeholder="Judul Tugas">
      <textarea id="taskCode"></textarea>
      <button onclick="submitTask()">Kirim</button>
    </div>

    <div id="tasks" class="hidden">
      <h2>Tugas Masuk</h2>
      <div id="taskList"></div>
    </div>
  </div>
</div>

<script>
/* ================= ENV (SIMULASI) ================= */
window.ENV={
  SUPABASE_URL:"https://YOUR_PROJECT_ID.supabase.co",
  SUPABASE_ANON_KEY:"YOUR_PUBLIC_ANON_KEY"
};

/* ================= SUPABASE ================= */
const supabase = supabaseJs.createClient(
  ENV.SUPABASE_URL,
  ENV.SUPABASE_ANON_KEY
);

/* ================= USER STATIC (DEMO) ================= */
const users={
  "Nicolas Tok":{pass:"ber217an",role:"admin"},
  "clairine":{pass:"backburner",role:"user"},
  "wixander":{pass:"backburner",role:"user"},
  "angel":{pass:"backburner",role:"user"}
};

let currentUser=null;

/* ================= LOGIN ================= */
function login(){
const u=userInput.value;
if(users[u].pass===passInput.value){
currentUser=u;
loginBox();
}else alert("Password salah");
}

function loginBox(){
login.style.display="none";
app.classList.remove("hidden");
ava.innerText=currentUser[0];
uname.innerText=currentUser;
buildMenu();
loadHome();
}

/* ================= MENU ================= */
function buildMenu(){
menu.innerHTML=`
<button onclick="show('home')">üè† Beranda</button>
${users[currentUser].role==="admin"?`
<button onclick="show('editor')">üíª Upload Materi</button>
<button onclick="show('tasks')">üì• Tugas Masuk</button>`:""}
<button onclick="show('submit')">üìù Kumpul Tugas</button>
<button onclick="location.reload()">üö™ Keluar</button>`;
}

function show(id){
["home","editor","submit","tasks"].forEach(x=>{
document.getElementById(x).classList.add("hidden");
});
document.getElementById(id).classList.remove("hidden");
if(id==="home")loadHome();
if(id==="tasks")loadTasks();
}

/* ================= MATERI ================= */
async function uploadMateri(){
if(users[currentUser].role!=="admin")return;
const name=fileName.value;
const code=codeArea.value;

await supabase
.from("materi")
.insert({name,content:code});

fileName.value="";codeArea.value="";
loadHome();
}

async function loadHome(){
home.innerHTML="<h2>Beranda</h2>";
const {data}=await supabase.from("materi").select();
data.forEach(d=>{
home.innerHTML+=`
<div class="card">
<b>${d.name}</b>
<pre>${d.content}</pre>
</div>`;
});
}

/* ================= TUGAS ================= */
async function submitTask(){
await supabase.from("tasks").insert({
user:currentUser,
title:taskTitle.value,
code:taskCode.value
});
alert("Tugas terkirim");
taskTitle.value="";taskCode.value="";
}

async function loadTasks(){
taskList.innerHTML="";
const {data}=await supabase.from("tasks").select();
data.forEach(t=>{
taskList.innerHTML+=`
<div class="card">
<b>${t.user} - ${t.title}</b>
<pre>${t.code}</pre>
</div>`;
});
}
</script>

</body>
</html>
